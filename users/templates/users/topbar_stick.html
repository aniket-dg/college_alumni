{% load static %}
<div class="topbar stick">
		<div class="logo">
			<a title="" href="newsfeed.html"><img src="{% static 'images/logo_1.gif' %}" alt=""></a>
		</div>

		<div class="top-area">
			<ul class="main-menu">
				<li>
					<a href="#" title="">Home</a>
					<ul>
						<li><a href="index-2.html" title="">Home Social</a></li>
						<li><a href="index2.html" title="">Home Social 2</a></li>
						<li><a href="index-company.html" title="">Home Company</a></li>
						<li><a href="landing.html" title="">Login page</a></li>
						<li><a href="logout.html" title="">Logout Page</a></li>
						<li><a href="newsfeed.html" title="">news feed</a></li>
					</ul>
				</li>
				<li>
					<a href="#" title="">timeline</a>
					<ul>
						<li><a href="time-line.html" title="">timeline</a></li>
						<li><a href="timeline-friends.html" title="">timeline friends</a></li>
						<li><a href="timeline-groups.html" title="">timeline groups</a></li>
						<li><a href="timeline-pages.html" title="">timeline pages</a></li>
						<li><a href="timeline-photos.html" title="">timeline photos</a></li>
						<li><a href="timeline-videos.html" title="">timeline videos</a></li>
						<li><a href="fav-page.html" title="">favourit page</a></li>
						<li><a href="groups.html" title="">groups page</a></li>
						<li><a href="page-likers.html" title="">Likes page</a></li>
						<li><a href="people-nearby.html" title="">people nearby</a></li>
					</ul>
				</li>
				<li>
					<a href="#" title="">account settings</a>
					<ul>
						<li><a href="create-fav-page.html" title="">create fav page</a></li>
						<li><a href="edit-account-setting.html" title="">edit account setting</a></li>
						<li><a href="edit-interest.html" title="">edit-interest</a></li>
						<li><a href="edit-password.html" title="">edit-password</a></li>
						<li><a href="edit-profile-basic.html" title="">edit profile basics</a></li>
						<li><a href="edit-work-eductation.html" title="">edit work educations</a></li>
						<li><a href="messages.html" title="">message box</a></li>
						<li><a href="inbox.html" title="">Inbox</a></li>
						<li><a href="notifications.html" title="">notifications page</a></li>
					</ul>
				</li>
				<li>
					<a href="#" title="">more pages</a>
					<ul>
						<li><a href="404.html" title="">404 error page</a></li>
						<li><a href="about.html" title="">about</a></li>
						<li><a href="contact.html" title="">contact</a></li>
						<li><a href="faq.html" title="">faq's page</a></li>
						<li><a href="insights.html" title="">insights</a></li>
						<li><a href="knowledge-base.html" title="">knowledge base</a></li>
						<li><a href="widgets.html" title="">Widgts</a></li>
					</ul>
				</li>
			</ul>
			<ul class="setting-area">
				<li>
					<a href="#" title="Home" data-ripple=""><i class="ti-search"></i></a>
					<div class="searched">
						<form method="post" class="form-search">
							<input oninput="searchUsers(event, this)" id="tipue_drop_input" type="text" placeholder="Search Friend">
                            <div class="card" id="tipue_drop_wrapper" style="width: 18rem;">
                                <ul class="list-group list-group-flush">

                                </ul>
                            </div>
							<button data-ripple><i class="ti-search"></i></button>
						</form>
					</div>


				</li>
                <script>
                    let searchTimer;
                                function searchUsers(e, element) {
                                    const query = element.value.trim()
                                    if (query){
                                        clearTimeout(searchTimer);
                                        searchTimer = setTimeout(() => {
                                            setResults(query);
                                        }, 1000);
                                    } else {
                                        clearTimeout(searchTimer);
                                        $('#tipue_drop_content').hide()
                                        $('#tipue_drop_content_mobile').hide()

                                        $('#tipue_drop_wrapper').empty()
                                        $('#tipue_drop_wrapper_mobile').empty()
                                    }
                                }

                    function setResults(query) {
                                    $.getJSON(`/users/search/?query=${query}`, function (data) {
                                        console.log(data);
                                        let userResultEl = '';
                                        data['user_list']?.forEach((user)=> {

                                            userResultEl += `
                                            ${user.is_friend ?
                                                `<a href="/user/profile/${user.id}">`
                                                    :
                                                `<a href="/user/profile/${user.id}">`}
                                                    <div class="tipue_drop_item">
                                                        <div class="tipue_drop_left">
                                                            <img height="50px" width="50px" src="${user.profile_image_url}" class="tipue_drop_image">
                                                        </div>
                                                        <div class="tipue_drop_right" style="width: 220px">
                                                            <div style="display:flex; justify-content: space-between; align-items: center;">
                                                                <div>
                                                                    ${user.name}
                                                                    <div>
                                                                        <small>${user.username}</small>
                                                                    </div>
                                                                </div>
                                                                ${user.is_friend == 1 ?
                                                                    `
                                                                    <div class="p-1 px-2">&#10003; Sent</div>
                                                                    `
                                                                    :
                                                                    user.is_friend == 2 ?
                                                                        ``
                                                                        :
                                                                        `
                                                                            <a style="cursor:pointer" onclick="window.location= window.location.origin+'/users/send/request/?id=${user.id}'"> Send Request</button>
                                                                        `
                                                                }
                                                                <div style="display:none" class="p-1 px-2">&#10003; Sent</div>
                                                        </div>
                                                    </div>
                                                </a>
                                            `

                                        });

                                    $('#tipue_drop_wrapper').append(userResultEl)
                                        userResultEl = '';
                                        });

                                }

                </script>
				<li><a href="newsfeed.html" title="Home" data-ripple=""><i class="ti-home"></i></a></li>
				<li>
					<a href="#" title="Notification" data-ripple="">
						<i class="ti-bell"></i><span>20</span>
					</a>
					<div class="dropdowns">
						<span>4 New Notifications</span>
						<ul class="drops-menu">
							<li>
								<a href="notifications.html" title="">
									<img src="images/resources/thumb-1.jpg" alt="">
									<div class="mesg-meta">
										<h6>sarah Loren</h6>
										<span>Hi, how r u dear ...?</span>
										<i>2 min ago</i>
									</div>
								</a>
								<span class="tag green">New</span>
							</li>
							<li>
								<a href="notifications.html" title="">
									<img src="images/resources/thumb-2.jpg" alt="">
									<div class="mesg-meta">
										<h6>Jhon doe</h6>
										<span>Hi, how r u dear ...?</span>
										<i>2 min ago</i>
									</div>
								</a>
								<span class="tag red">Reply</span>
							</li>
							<li>
								<a href="notifications.html" title="">
									<img src="images/resources/thumb-3.jpg" alt="">
									<div class="mesg-meta">
										<h6>Andrew</h6>
										<span>Hi, how r u dear ...?</span>
										<i>2 min ago</i>
									</div>
								</a>
								<span class="tag blue">Unseen</span>
							</li>
							<li>
								<a href="notifications.html" title="">
									<img src="images/resources/thumb-4.jpg" alt="">
									<div class="mesg-meta">
										<h6>Tom cruse</h6>
										<span>Hi, how r u dear ...?</span>
										<i>2 min ago</i>
									</div>
								</a>
								<span class="tag">New</span>
							</li>
							<li>
								<a href="notifications.html" title="">
									<img src="images/resources/thumb-5.jpg" alt="">
									<div class="mesg-meta">
										<h6>Amy</h6>
										<span>Hi, how r u dear ...?</span>
										<i>2 min ago</i>
									</div>
								</a>
								<span class="tag">New</span>
							</li>
						</ul>
						<a href="notifications.html" title="" class="more-mesg">view more</a>
					</div>
				</li>
				<li>
					<a href="#" title="Messages" data-ripple=""><i class="ti-comment"></i><span>12</span></a>
					<div class="dropdowns">
						<span>5 New Messages</span>
						<ul class="drops-menu">
							<li>
								<a href="notifications.html" title="">
									<img src="images/resources/thumb-1.jpg" alt="">
									<div class="mesg-meta">
										<h6>sarah Loren</h6>
										<span>Hi, how r u dear ...?</span>
										<i>2 min ago</i>
									</div>
								</a>
								<span class="tag green">New</span>
							</li>
							<li>
								<a href="notifications.html" title="">
									<img src="images/resources/thumb-2.jpg" alt="">
									<div class="mesg-meta">
										<h6>Jhon doe</h6>
										<span>Hi, how r u dear ...?</span>
										<i>2 min ago</i>
									</div>
								</a>
								<span class="tag red">Reply</span>
							</li>
							<li>
								<a href="notifications.html" title="">
									<img src="images/resources/thumb-3.jpg" alt="">
									<div class="mesg-meta">
										<h6>Andrew</h6>
										<span>Hi, how r u dear ...?</span>
										<i>2 min ago</i>
									</div>
								</a>
								<span class="tag blue">Unseen</span>
							</li>
							<li>
								<a href="notifications.html" title="">
									<img src="images/resources/thumb-4.jpg" alt="">
									<div class="mesg-meta">
										<h6>Tom cruse</h6>
										<span>Hi, how r u dear ...?</span>
										<i>2 min ago</i>
									</div>
								</a>
								<span class="tag">New</span>
							</li>
							<li>
								<a href="notifications.html" title="">
									<img src="images/resources/thumb-5.jpg" alt="">
									<div class="mesg-meta">
										<h6>Amy</h6>
										<span>Hi, how r u dear ...?</span>
										<i>2 min ago</i>
									</div>
								</a>
								<span class="tag">New</span>
							</li>
						</ul>
						<a href="messages.html" title="" class="more-mesg">view more</a>
					</div>
				</li>
				<li><a href="#" title="Languages" data-ripple=""><i class="fa fa-globe"></i></a>
					<div class="dropdowns languages">
						<a href="#" title=""><i class="ti-check"></i>English</a>
						<a href="#" title="">Arabic</a>
						<a href="#" title="">Dutch</a>
						<a href="#" title="">French</a>
					</div>
				</li>
			</ul>
			<div class="user-img">
				<img src="images/resources/admin.jpg" alt="">
				<span class="status f-online"></span>
				<div class="user-setting">
					<a href="#" title=""><span class="status f-online"></span>online</a>
					<a href="#" title=""><span class="status f-away"></span>away</a>
					<a href="#" title=""><span class="status f-off"></span>offline</a>
					<a href="#" title=""><i class="ti-user"></i> view profile</a>
					<a href="#" title=""><i class="ti-pencil-alt"></i>edit profile</a>
					<a href="#" title=""><i class="ti-target"></i>activity log</a>
					<a href="#" title=""><i class="ti-settings"></i>account setting</a>
					<a href="#" title=""><i class="ti-power-off"></i>log out</a>
				</div>
			</div>
			<span class="ti-menu main-menu" data-ripple=""></span>
		</div>
	</div><!-- topbar -->

<section>
			<div class="feature-photo">
				<figure><img src="{{ profile_user.get_cover_img }}" alt=""></figure>

            {% if profile_user != request.user and profile_user not in request.user.get_user_connected_users %}
            <div class="add-btn">
				<a href="{% url 'user:send-request' %}?id={{ profile_user.id}}" title="" data-ripple="">Add Friend</a>
			</div>
            {% endif %}
            {% if profile_user == request.user %}
				<form class="edit-phto" id="coverPhotoForm" method="post" enctype="multipart/form-data" action="{% url 'user:user-cover-photo' user.id %}">
                    {% csrf_token %}
					<i class="fa fa-camera-retro"></i>
					<label class="fileContainer">
						Edit Cover Photo
					<input type="file"  name="cover_image" onchange="$('#coverPhotoForm').submit()"/>
					</label>
				</form>
             {% endif %}
				<div class="container-fluid">
					<div class="row merged">
						<div class="col-lg-2 col-sm-3">
							<div class="user-avatar">
								<figure>
									<img src="{{ profile_user.get_profile_img }}" alt="">
                                    {% if profile_user == request.user %}
									<form class="edit-phto" id="profilePhotoForm" enctype="multipart/form-data" method="post" action="{% url 'user:user-profile-photo' user.id %}">
										{% csrf_token %}
                                        <i class="fa fa-camera-retro"></i>
										<label class="fileContainer">
											Edit Display Photo
											<input type="file" name="profile_image" onchange="$('#profilePhotoForm').submit()"/>
										</label>
									</form>
                                    {% endif %}
								</figure>
							</div>
						</div>
						<div class="col-lg-10 col-sm-9">
							<div class="timeline-info">
								<ul>
									<li class="admin-name">
									  <h5>{{ profile_user.get_full_name }}</h5>
									  <span>Group Admin</span>
									</li>
									<li>
                                        {% if request.user == profile_user %}
										    <a class="" id="timeline_panel" href="{% url 'user:user-timeline' %}" title="" data-ripple="">time line</a>
										    <a class="" id="friend_panel" href="{% url 'user:profile' %}" title="" data-ripple="">Friends</a>
										    <a class="" id="groups_panel" href="{% url 'user:user-groups' %}" title="" data-ripple="">Groups</a>
                                            <a class="" id="about_panel" href="{% url 'user:user-basic-info' %}" title="" data-ripple="">about</a>

										{% elif profile_user in request.user.get_user_connected_users %}
                                            <a class="" id="timeline_panel" href="{% url 'user:user-friend-timeline' profile_user.id %}" title="" data-ripple="">time line</a>
										    <a class="" id="friend_panel" href="{% url 'user:user-user-friend' profile_user.id %}" title="" data-ripple="">Friends</a>
										    <a class="" id="groups_panel" href="{% url 'user:user-friend-groups' profile_user.id %}" title="" data-ripple="">Groups</a>
                                            <a class="" id="about_panel" href="{% url 'user:friend-profile' profile_user.id %}" title="" data-ripple="">about</a>
                                        {% endif %}
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
	</section><!-- top area -->
